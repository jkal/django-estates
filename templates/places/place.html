{% extends "base.html" %}

{% block title %}
    {{ place }}
{% endblock %}

{% block style %}
<link rel="stylesheet" href="/static/js/jquery.notice.css" type="text/css" /> 
<script type="text/javascript" src="/static/js/jquery.notice.js"></script> 
{% endblock %}

{% block script %}
<script>
    $(document).ready(function() {

        $("a.thumb").fancybox({
            'padding'       : 0,
            'transitionIn'  : 'elastic',
            'transitionOut' : 'elastic'
        });

        $("#favlink").click(function() {
            $.ajax({
                type: "GET",
                url: "/places/{{ place.pk }}/fave/",
                data: " ",
                cache: false,
                    
                success: function(data) {
                    jQuery.noticeAdd({
                        text: '<h2>Notice</h2><p>' + data + '</p>',
                        stay: false
                    });
                },  
                error: function(textStatus) { 
                    jQuery.noticeAdd({
                        text: '<strong>Error!</strong><p>Ajax request failed:' + textStatus + '</p>',
                        stay: false
                    });
                },
            }); 
        });

        var myLatlng = new google.maps.LatLng({{ place.latitude }}, {{ place.longitude }});
        var myOptions = {
            zoom: 15,
            center: myLatlng,
            mapTypeId: google.maps.MapTypeId.ROADMAP
        }
        
        var map = new google.maps.Map(document.getElementById("map"), myOptions);
        var marker = new google.maps.Marker({
            position: myLatlng, 
            map: map, 
            title:"{{ place }}"
        });  
    });
</script>
{% endblock %}

{% block content %}

{% include "menu.html" %}

<ul id="posts" >

    <li class="post">
        <h4>
            <a href="" title="">{{ place.category.name }} &bull; {{ place.address}}, {{ place.city}}</a>
            {% if place.submitter == user %}
                <span style="color:#ff0000;font-size:80%;padding-left:5px;"><a title="You can delete this place." href="/places/{{ place.pk }}/delete/">[&times;]</a></span>
            {% endif %}
        </h4>
        <a href="#" class="image"><div id="map" style="height: 100%;">&nbsp</div></a>
        
        <p class="meta">
            Εμβαδόν <a href="" rel="tag">{{ place.area }} m&sup2;</a> &bull;
            Τιμή <a href="" rel="tag">{{ place.price }} $</a> &bull;
            Έτος Κατασκευής <a href="" rel="tag">{{ place.year }}</a> 
        </p>

        <div class="post-content">
            <p>{{ place.description }}</p>
            <a id="favlink">Favorite this place!</a>
        </div>

        <p class="images">
            <a rel="thumb_group" class="thumb" href="/static/img/sample.jpg">
                <img alt="thumb_group" src="/static/img/photo.png" />
            </a>
            <a rel="thumb_group" class="thumb" href="/static/img/sample.jpg">
                <img alt="thumb_group" src="/static/img/photo.png" />
            </a>
            <a rel="thumb_group" class="thumb" href="/static/img/sample.jpg">
                <img alt="thumb_group" src="/static/img/photo.png" />
            </a>
        </p>
        <p class="date">Submitted on {{ place.pub_date }} by {{ place.submitter.username }}</p>
    </li>
</ul>
{% endblock %}
